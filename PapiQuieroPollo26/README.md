# PCSecure V5.0.8.16 - Use of Hard-coded Credentials in configuration files leads to admin panel access

## Summary
Vendor: PCTechSoft SAS

Product: PCSecure

Affected version(s): 5.0.8.16

CodeName: PapiQuieroPollo26

## Vulnerability
Type: Use of Hard-coded Credentials (CWE-798)

CVSSv3.1 Vector: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

CVSSv3.1 Base Score: 9.3 (Critical)

Exploit available: No

CVE ID: ---

## Description
The Configuration file (system.bmp) in PCSecure V5.0.8.16 stores the credentials for access to admin panel, which allows a local user without privileges to login in as administrator and execute commands as windows local admin or reduce security control via reading the file from Chrome or Firefox and decoding username and password using ROT-23 Cipher.

## Proof of Concept
### Demo
![demo](./PapiQuieroPollo26-Demo.gif)

### Steps to reproduce
1. Read the file system.bmp from Chrome using the following URI: "view-source:file:///C:/Program%20Files/Common%20Files/CONFIG/system.bmp"

2. Decode content using any ROT-23 Cipher decoder.

3. Identify the password for each user. The first line contains all the usernames separed by "*", the second line contains the password for each username, Ex.:
----------Decoded_File----------
-ADMIN-Soporte4-Soporte5-
-PCSECURE-soporte4-soporte5-
----------Decoded_File----------
Cred:
ADMIN:PCSECURE

4. Launch PCSecure admin panel.
Press Ctrl + Mayus + P or launch from windows Start menu.

5. Login as Admin

6. Change security profile and execute any command

### Tested on
Windows 7

## Exploit
There is no exploit for the vulnerability but can be manually exploited.

## Mitigation
There is currently no patch available for this vulnerability.

## Credits
The vulnerability was discovered by Oreocato aka [Miguel Chaparro Pedraza](https://www.linkedin.com/in/miguel-chaparro-pedraza)

## References
Vendor page: https://www.pctechsoft.net

## Timeline
2019-09-07: Vulnerability discovered.

2019-09-07: Vendor contacted.

2022-09-28: Public Disclosure.
